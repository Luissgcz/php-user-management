# Ativa a reescrita de URLs
RewriteEngine On
RewriteBase /MVC/

# Bloqueia listagem de diretórios
Options -Indexes

# Redireciona erro 403 para página personalizada
ErrorDocument 403 http://localhost/mvc/error403

######################
# BLOQUEIOS DE ACESSO
######################

# BLOQUEAR ACESSO DIRETO A DIRETÓRIOS SENSÍVEIS
# (app, vendor, logs, etc.)

RewriteCond %{REQUEST_URI} (^|/)app/ [NC]
RewriteRule ^ - [F]

RewriteCond %{REQUEST_URI} (^|/)vendor/ [NC]
RewriteRule ^ - [F]

RewriteCond %{REQUEST_URI} (^|/)logs/ [NC]
RewriteRule ^ - [F]

# (Exemplo de exceção: para liberar controllers/errors, adicione isso acima do bloqueio de /app/)
# RewriteCond %{REQUEST_URI} ^/MVC/app/controllers/errors [NC]
# RewriteRule ^ - [L]

##########################
# BLOQUEIO DE ARQUIVOS SENSÍVEIS
##########################

<FilesMatch "^(\.htaccess|\.gitignore|composer\.(json|lock)|README\.md|LICENSE)$">
    Require all denied
</FilesMatch>

##########################
# URL AMIGÁVEL MVC
##########################

# Se o arquivo ou diretório não existir, redireciona para index.php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
